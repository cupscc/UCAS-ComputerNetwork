# 计算机网络第二次作业

王畅路2019K8009907018

#### 1.

简述IP地址相较于MAC地址编址方案有何本质的不同? 试分析IP地址编址方案的优势与不足

mac地址编址方案：IEEE 的注册管理机构 RA 负责向厂家分配地址字段的前3个字节(即高位 23 位，其中第一字节的最低位表示单播/组播地址，单播“0”)。后3个字节(即低位 24 位)由厂家自行指派，称为扩展标识符，必须保证生产出的适配器没有重复地址。

答：

ip地址编址方案：分类编址。



ip地址的编址表明了一个地址的网络号和主机号，既是位置也是身份，但是mac地址只是有厂商分配的地址，它仅仅代表一个身份。



ip分类编址的优势：使用网络号来区分网络，增加了查找效率，使得路由器的负担下降。

不足：ip地址的利用率比较低，给每一个物理网络分配一个网络号会使得路由表过于庞大，不易扩展。因此出现了划分子网和构造超网



#### 2.

在如下图所示的以太网链路上有 7 台主机，假设 ARP 缓存的有效期为 15 分钟，初始阶段各 主机的 ARP 缓存表为空。现假设第 2 分钟，H2 主动向 H5 发起了一次通信；第 7 分钟，H2 主动向 H6 发起了一次通信；第 12 分钟，H3 主动向 H2 发起了一次通信，请采用如下表格方 式给出第 15 分钟时，各主机中的 ARP 缓存表。（假设通信过程中各节点的 IP 地址和 MAC 地 址均不会发生改变，通信过程本身没有任何延时）

答：

假设缓存表足够大

第二分钟通信之后

H1，H3~H7的ARP缓存表如下：

<table>
<tr>
<th colspan = "3" align = "center" >ARP缓存表</th>
</tr>
<tr>
<th>ip地址</th>
<th>mac地址</th>
<th>剩余有效期</th>
</tr>
<tr>
<td>ip(H2)</td>
<td>mac(H2)</td>
<td>15</td>
</tr>
</table>


H2的ARP缓存表如下：

<table>
<tr>
<th colspan = "3" align = "center" >ARP缓存表</th>
</tr>
<tr>
<th>ip地址</th>
<th>mac地址</th>
<th>剩余有效期</th>
</tr>
<tr>
<td>ip(H5)</td>
<td>mac(H5)</td>
<td>15</td>
</tr>
</table>


第7分钟通信之后

H1，H3~7的缓存表仍然是：

<table>
<tr>
<th colspan = "3" align = "center" >ARP缓存表</th>
</tr>
<tr>
<th>ip地址</th>
<th>mac地址</th>
<th>剩余有效期</th>
</tr>
<tr>
<td>ip(H2)</td>
<td>mac(H2)</td>
<td>15</td>
</tr>
</table>


H2的缓存表为

<table>
<tr>
<th colspan = "3" align = "center" >ARP缓存表</th>
</tr>
<tr>
<th>ip地址</th>
<th>mac地址</th>
<th>剩余有效期</th>
</tr>
<tr>
<td>ip(H5)</td>
<td>mac(H5)</td>
<td>10</td>
</tr>
<tr>
<td>ip(H6)</td>
<td>mac(H6)</td>
<td>15</td>
</tr>
</table>


第12分钟时，由于H3有H2的表项，因此不需要广播，缓存表只改变了剩余有效期

这个时候H1，H4~H7的缓存表是

<table>
<tr>
<th colspan = "3" align = "center" >ARP缓存表</th>
</tr>
<tr>
<th>ip地址</th>
<th>mac地址</th>
<th>剩余有效期</th>
</tr>
<tr>
<td>ip(H2)</td>
<td>mac(H2)</td>
<td>10</td>
</tr>
</table>


H3的缓存表是

<table>
<tr>
<th colspan = "3" align = "center" >ARP缓存表</th>
</tr>
<tr>
<th>ip地址</th>
<th>mac地址</th>
<th>剩余有效期</th>
</tr>
<tr>
<td>ip(H2)</td>
<td>mac(H2)</td>
<td>15</td>
</tr>
</table>


H2的缓存表是

<table>
<tr>
<th colspan = "3" align = "center" >ARP缓存表</th>
</tr>
<tr>
<th>ip地址</th>
<th>mac地址</th>
<th>剩余有效期</th>
</tr>
<tr>
<td>ip(H5)</td>
<td>mac(H5)</td>
<td>5</td>
</tr>
<tr>
<td>ip(H6)</td>
<td>mac(H6)</td>
<td>10</td>
</tr>
</table>


第15分钟时，有效期均减三

<table>
<tr>
<th colspan = "3" align = "center" >ARP缓存表</th>
</tr>
<tr>
<th>ip地址</th>
<th>mac地址</th>
<th>剩余有效期</th>
</tr>
<tr>
<td>ip(H2)</td>
<td>mac(H2)</td>
<td>7</td>
</tr>
</table>


H3的缓存表是

<table>
<tr>
<th colspan = "3" align = "center" >ARP缓存表</th>
</tr>
<tr>
<th>ip地址</th>
<th>mac地址</th>
<th>剩余有效期</th>
</tr>
<tr>
<td>ip(H2)</td>
<td>mac(H2)</td>
<td>12</td>
</tr>
</table>


H2的缓存表是

<table>
<tr>
<th colspan = "3" align = "center" >ARP缓存表</th>
</tr>
<tr>
<th>ip地址</th>
<th>mac地址</th>
<th>剩余有效期</th>
</tr>
<tr>
<td>ip(H5)</td>
<td>mac(H5)</td>
<td>2</td>
</tr>
<tr>
<td>ip(H6)</td>
<td>mac(H6)</td>
<td>7</td>
</tr>
</table>


#### 3.

在如下所示的 IP 报头中，Identification、Flag、Offset 等三个字段是为了数据包分片而定义的。 假设IP报头长度固定为20字节，数据长度可变。在一条最大传送单元MTU（Maximum Transfer  Unit）为 1200 字节的链路上传输长度为 3620 的 IP 数据包，请回答下列问题： 

（1）分片数据包偏移量以 8 字节为单位，请给出采用 8 字节作为偏移量单位的理由。 

（2）对该数据包进行分片，至少应该分为多少片？ 

（3）各分片包的偏移量应是多少？



1.因为片段偏移字段比总长度字段即16比特（并且2^3是8）短3比特。片偏移以8个字节为偏移单位，即每个分片的长度一定是8字节的整数倍。

2.不包含头部，IP数据包是3600个字节，因此需要分成3片

3.偏移量以8字节为单位，分别是 0 150 300

#### 4.

 IP 数据包由“IP 报头+数据”两部分组成，其中 IP 报头长度固定为 20 字节，数据长度可变。采用如下方式对“IP 传输的有效载荷率”进行定义：数据部分长度/ IP 数据包长度 × 100%。假设在一条最大传送 单元 MTU（Maximum Transfer Unit）为 1200 字节的链路上传输 IP 数据包，请回答以下问题 （采用四舍五入，精确到小数点后两位，即 xx.xx%）。 

（1）假设 IP 数据包的长度为 1000 字节，IP 传输的有效载荷率最大是多少？ 

（2）假设 IP 数据包的长度为 3620 字节，IP 传输的有效载荷率最大是多少？

答：

1.不需要分片，因此，

$980/1000 = 98\%$ 

2.需要分片，IP数据包将会被分成三片

IP报头固定为20字节，需要三个分片，每个分片的数据部分长度是1200字节，因此

$3600/3660 = 98.36%$

#### 5.

某公司网络如下图所示。IP 地址空间 192.168.1.0/24 被均分给销售部和技术部两个子网，并 已分别为部分主机和路由器接口分配了 IP 地址，销售部子网的 MTU=1500B，技术部子网的 MTU=800B。请问销售部子网的广播地址是什么？技术部子网的子网地址是什么？若每个主机仅分配一个 IP 地址，则技术部子网还可以连接多少台主机？（假设全 0 和全 1 的地址均可 以使用）

答：

因为ip地址空间被均分，因此销售部和技术部的子网掩码应该为255.255.255.128

技术部子网的子网地址是 192.168.1.129 & 255.255.255.128 = 192.168.1.128

广播地址是主机号全为1的ip地址，销售部的子网地址为192.168.1.0，因此广播地址就是192.168.1.127

技术部子网的ip地址空间为192.168.1.128~192.168.1.255，共有128个地址，已经分配了80个地址，还有48个地址可以使用，除去路由器端口ip，假设全 0 和全 1 的地址均可以使用，可以连接47台主机。

#### 6.

在互联网中，某计算机的 IP 地址是 11001010.01100000.00101100.01011000，请回答下列问题：

 (1) 请用十进制数表示上述 IP 地址？ 

 (2) 请写出该 IP 地址在没有划分子网时的子网掩码？

 (3) 将该 IP 地址所在的网络划分为 4 个地址空间大小相等的子网（子网号可以全 0 或全 1）， 写出 4 个子网的子网掩码和 IP 地址区间

答：

1.   202.96.44.88

2.   IP地址以110开头，因此应该是C类地址，没有划分子网的时候默认的子网掩码是255.255.255.0

3.   需要借用两位主机号，因此四个子网的子网掩码都是255.255.255.192

     | 子网 | 地址区间                      |
     | ---- | ----------------------------- |
     | 1    | 202.96.44.0 ~ 202.96.44.63    |
     | 2    | 202.96.44.64 ~ 202.96.44.127  |
     | 3    | 202.96.44.128 ~ 202.96.44.191 |
     | 4    | 202.96.44.192 ~ 202.96.44.255 |

#### 7.

通过路由聚合技术，多个小地址块可以聚合在在一起，形成更大的地址块。请问网络前缀长度为 14 的地址块，是否可能由多个 B 类地址块和多个 C 类地址块共同聚合而成？请说明理由。

答



前缀不同，无法聚合 路由聚合只能聚合连续的地址

B类开头为10 C类开头为110

#### 8.

请给出路由器 A 更新后的路由表

答：

C的所有表项距离加一

| 目的网络 | 距离 |
| -------- | ---- |
| N1       | 3    |
| N2       | 3    |
| N3       | 4    |
| N4       | 4    |
| N5       | 5    |

和A的表项比较之后，更新A的表项为

| 目的网络 | 距离 | 下一跳路由 |
| -------- | ---- | ---------- |
| N1       | 3    | C          |
| N2       | 1    | C          |
| N3       | 1    | F          |
| N4       | 4    | C          |
| N5       | 5    | C          |

#### 9.

假设网络中某路由器维护如下所示的路由表，现该路由收到目的地址为 206.0.71.128 的数据 包，请问路由器应该将数据包转发到哪一个下一跳节点（请给出简单的过程）

答：

ip地址并上子网掩码得到网络号分别为

1.    206.0.68.0
2.    206.0.68.0
3.    206.0.70.0
4.    206.0.71.0
5.    206.0.71.128

目的地址为206.0.71.128的数据包和第五条表项的地址匹配，根据最长匹配算法，不会有比表项五更长的匹配地址，因此下一跳节点为H5

#### 10.

某公司网络拓扑图如下所示，路由器 R1 通过接口 E1、E2、E3、E4 分别连接局域网 1、局域网 2、局域网 3、局域网 4，通过接口 L0 连接路由器 R2，并通过路由器 R2 连接域名服务器与互联网。R1 的 L0 接口的 IP 地址是 202.203.2.1；R2 的 L0 接口的 IP 地址是 202.203.2.2， L1 接口的 IP 地址是 120.111.12.1，E0 接口的 IP 地址是 202.203.3.1；域名服务器的 IP 地址是202.203.3.2。 

（1）将 IP 地址空间 202.203.1.0/24 划分为 4 个子网，分别分配给局域网 1、局域网 2、局域网 3、局域网 4，每个局域网需分配的 IP 地址数不少于 60 个。请给出子网划分结果，说明理 由或给出必要的计算过程。 

（2）请给出 R1 的路由表，使其明确包括到局域网 1、局域网 2、局域网 3、局域网 4 的路 由、域名服务器的主机路由和互联网的路由。 

（3）请采用路由聚合技术，给出 R2 到局域网 1、局域网 2、局域网 3、局域网 4 的路由

答

1.划分成四个子网，需要借用两位主机号

| 局域网 | IP地址空间                  | 子网号        |
| ------ | --------------------------- | ------------- |
| 1      | 202.203.1.1~202.203.1.62    | 202.203.1.0   |
| 2      | 202.203.1.65~202.203.1.126  | 202.203.1.64  |
| 3      | 202.203.1.129~202.203.1.190 | 202.203.1.128 |
| 4      | 202.203.1.193~202.203.1.254 | 202.203.1.192 |

2.

| 目的网络ip    | 子网掩码        | 下一跳ip    | 接口 |
| ------------- | --------------- | ----------- | ---- |
| 202.203.1.0   | 255.255.255.128 | -           | E1   |
| 202.203.1.64  | 255.255.255.128 | -           | E2   |
| 202.203.1.128 | 255.255.255.128 | -           | E3   |
| 202.203.1.192 | 255.255.255.128 | -           | E4   |
| 202.203.3.2   | 255.255.255.255 | 202.203.2.2 | L0   |
| 120.111.12.1  | 0.0.0.0         | 202.203.2.2 | L0   |

3.

| 目的网络ip  | 子网掩码      | 下一跳ip    | 接口 |
| ----------- | ------------- | ----------- | ---- |
| 202.203.1.0 | 255.255.255.0 | 202.203.2.1 | L0   |

#### 11.

OSPF 是链路状态路由协议，其通过 Dijkstra 算法每次从“未选择节点集”选择一个距离源节点 最近的节点加入到“已选择节点集”当中，然后更新“未选择节点集”中各节点到源节点的距离。 在下图所示的拓扑中，源节点 S 执行算法生成路由表，请按照 {已选则节点集，未选择节点 集}的形式，逐步给出算法的执行过程。

（注：1.只描述每个步骤完成后，两个集合中的节点标号即可；

​	 2.对于距离相同的多个节点，优先选择“节点标号字母顺序“较小的节点；

​	 3.算法 开始执行时的状态为{ {S}，{A，B，C，D，E，F，G} }

![image-20220426122412278](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220426122412278.png)

| 次数 | 已选择          | 未选择        |
| ---- | --------------- | ------------- |
| 1    | S               | A,B,C,D,E,F,G |
| 2    | S,C             | A,B,D,E,F,G   |
| 3    | S,C,A           | B,D,E,F,G     |
| 4    | S,C,A,D         | B,E,F,G       |
| 5    | S,C,A,D,G       | B,E,F         |
| 6    | S,C,A,D,G,E     | B,F           |
| 7    | S,C,A,D,G,E,F   | B             |
| 8    | S,C,A,D,G,E,F,B | -             |

#### 12.

IP 多播技术是在网络层实现多点访问的技术，在 IP 多播的最后一跳，需要采用硬件多播技术 予以实现，即基于多播 IP 地址映射为硬件多播地址，支持最后一跳路由器到本地所有多播成员的数据传输，请分析这种设计思路的基本原理。

答：

类似于域内路由聚合，在整个网络上，将整个ip多播组看成一个主机，只有在最后一跳才使用硬件多播技术把数据包传送到每个多播成员。

#### 13.

虚拟专用网是基于 VPN 网关连通内部网络而形成的，支持远程私有地址与私有地址之间的通信；网络地址转换是基于 NAT 网关实现的功能，支持私有地址与公有地址之间的通信。请分别描述在上述两种场景中，网关所需要实现的功能。

答：

VPN：网关需要对数据包进行封装加密，使用IP隧道发送到另一个私有地址

NAT：NAT会把内部网络ip转换成一个公有ip，并且分配一个端口号。网关会记录这个公有ip和端口号，当需要进行数据交换的时候会使用这个表项。
